---
# Master control
enabled: true

# Code quality checks
typescript:
  command: npx tsc --noEmit
python:
  mypy_command: mypy .
  ruff_command: ruff check .
go:
  command: go build ./...
rust:
  command: cargo check

# Auto-formatting (NEW)
autoformat:
  enabled: true

# Git checkpointing (NEW)
git_checkpoint:
  enabled: true

# Audio notifications (NEW - ENHANCED!)
notifications:
  enabled: true

  # Audio mode selection
  # - 'mixed': Sound effect + voice (recommended for fun!)
  # - 'tts_only': Voice announcements only
  # - 'sound_only': Sound effects only
  # - 'creative': Random fun sounds from library
  audio:
    mode: 'mixed'
    sound_library: '~/.claude/audio'  # Path to sound effects library

  # Approval Needed Notifications (when Claude needs your attention)
  # Hook: Notification
  approval:
    enabled: true
    sound: true          # Play attention-grabbing sound
    tts: true            # Speak "Approval needed, come back"
    voice: 'Trinoids'    # Voice profile (Trinoids, Bells, Wobble, Superstar)
    rate: 140            # Speech rate (words per minute)

  # Session Completion Notifications (when session ends)
  # Hook: Stop
  completion:
    enabled: true
    sound: true          # Play success/error sound
    tts: true            # Speak session summary
    contextual_voice: true  # Auto-select voice based on outcome

    # Optional: Override specific voices
    # (only used if contextual_voice is false)
    voices:
      success: 'Good News'   # Files modified successfully
      error: 'Bad News'      # Errors detected
      warning: 'Whisper'     # Warnings present
      neutral: 'Bubbles'     # No changes

  # TTS Global Settings
  tts:
    enabled: true
    timeout: 30           # Max TTS duration (seconds)
    rate_adjustment: 0    # +/- WPM modifier for all voices

# Observability tracking (NEW)
observability:
  enabled: false  # Set to true to enable session tracking
  langfuse:
    enabled: false  # Set to true to send data to Langfuse
    host: http://localhost:3000
    public_key: ""  # Your Langfuse public key
    secret_key: ""  # Your Langfuse secret key

# CLAUDE.md management (NEW)
claude_md_management:
  auto_init: true              # Auto-create CLAUDE.md if missing
  auto_update: true            # Update CLAUDE.md at session end
  update_threshold: 3          # Min tool calls before updating
  max_file_size: 10240         # 10KB size limit
  backup_before_update: true   # Create backup before each update
---

# Development Plugin Settings

This file configures all intelligent development automation features:
- **Code Quality Checks**: Type checking and linting on session end
- **Auto-Formatting**: Automatic code formatting after edits
- **Git Checkpointing**: Automatic commits with detailed messages
- **Safety Validations**: Blocks dangerous bash commands
- **Completion Notifications**: Mac notifications and TTS on completion
- **CLAUDE.md Management**: Auto-creates and maintains project context file

## Configuration Options

### enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Master switch to enable or disable the entire plugin

### Code Quality Checks

#### typescript
- **command**: TypeScript checking command (default: `npx tsc --noEmit`)

#### python
- **mypy_command**: MyPy type checking command (default: `mypy .`)
- **ruff_command**: Ruff linting command (default: `ruff check .`)

#### go
- **command**: Go build command (default: `go build ./...`)

#### rust
- **command**: Rust cargo command (default: `cargo check`)

### Auto-Formatting (NEW)

#### autoformat.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Enable/disable automatic code formatting after edits
- **Currently Supports**: TypeScript/JavaScript with prettier
- **Behavior**: Non-blocking (warns on failure, doesn't stop workflow)

### Git Checkpointing (NEW)

#### git_checkpoint.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Enable/disable automatic git commits at session end
- **Features**:
  - Auto-stages modified files
  - Generates detailed commit messages with diff summary
  - Skips silently if not a git repository
  - Blocks if merge conflicts detected

### Audio Notifications (NEW - ENHANCED!)

#### notifications.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Master switch for all notifications (audio and completion)

#### notifications.audio.mode
- **Type**: string (enum)
- **Default**: `'mixed'`
- **Options**: `'tts_only'`, `'sound_only'`, `'mixed'`, `'creative'`
- **Description**: Audio notification mode
  - `'tts_only'`: Voice announcements only
  - `'sound_only'`: Sound effects only
  - `'mixed'`: Sound effect first, then voice (recommended)
  - `'creative'`: Random fun sounds from library

#### notifications.audio.sound_library
- **Type**: string (path)
- **Default**: `'~/.claude/audio'`
- **Description**: Path to custom sound effects library
- **Structure**:
  ```
  ~/.claude/audio/
    success/   # Sounds for successful completions
    error/     # Sounds for errors/failures
    waiting/   # Sounds for processing/waiting
    notify/    # Sounds for notifications/alerts
  ```
- **Formats**: MP3, WAV, AIFF, M4A

#### notifications.approval.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Enable "Come back!" notifications when approval is needed
- **Hook**: Notification hook

#### notifications.approval.sound
- **Type**: boolean
- **Default**: `true`
- **Description**: Play attention-grabbing sound effect

#### notifications.approval.tts
- **Type**: boolean
- **Default**: `true`
- **Description**: Speak "Approval needed, come back" message

#### notifications.approval.voice
- **Type**: string
- **Default**: `'Trinoids'`
- **Options**: Any macOS voice (Trinoids, Bells, Wobble, Superstar, etc.)
- **Description**: TTS voice for approval notifications
- **Test**: `say -v "Trinoids" "Approval needed, come back"`

#### notifications.approval.rate
- **Type**: integer
- **Default**: `140`
- **Description**: Speech rate in words per minute (50-300+)

#### notifications.completion.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Enable session completion notifications
- **Hook**: Stop hook

#### notifications.completion.sound
- **Type**: boolean
- **Default**: `true`
- **Description**: Play success/error sound effect

#### notifications.completion.tts
- **Type**: boolean
- **Default**: `true`
- **Description**: Speak session summary

#### notifications.completion.contextual_voice
- **Type**: boolean
- **Default**: `true`
- **Description**: Auto-select voice based on session outcome
  - Success â†’ "Good News" (upbeat)
  - Errors â†’ "Bad News" (somber)
  - Warnings â†’ "Whisper" (cautious)
  - No changes â†’ "Bubbles" (neutral)

#### notifications.completion.voices
- **Type**: object
- **Description**: Override default voices when `contextual_voice` is false
- **Keys**: `success`, `error`, `warning`, `neutral`
- **Example**:
  ```yaml
  voices:
    success: 'Good News'
    error: 'Bad News'
    warning: 'Whisper'
    neutral: 'Bubbles'
  ```

#### notifications.tts.enabled
- **Type**: boolean
- **Default**: `true`
- **Description**: Global TTS enable/disable

#### notifications.tts.timeout
- **Type**: integer
- **Default**: `30`
- **Description**: Maximum TTS duration in seconds

#### notifications.tts.rate_adjustment
- **Type**: integer
- **Default**: `0`
- **Description**: +/- WPM modifier applied to all voices
- **Example**: `10` makes all voices 10 WPM faster

### Observability Tracking (NEW)

#### observability.enabled
- **Type**: boolean
- **Default**: `false`
- **Description**: Enable session tracking and observability
- **Features**:
  - Tracks all tool usage and file operations
  - Records session duration and metrics
  - Saves sessions locally to `.claude/observability/sessions/`
  - Optional Langfuse integration for visualization

#### observability.langfuse.enabled
- **Type**: boolean
- **Default**: `false`
- **Description**: Send observability data to Langfuse
- **Requires**: Langfuse SDK (`pip install langfuse`)

#### observability.langfuse.host
- **Type**: string
- **Default**: `http://localhost:3000`
- **Description**: Langfuse instance URL (local or remote)

#### observability.langfuse.public_key
- **Type**: string
- **Description**: Langfuse public API key

#### observability.langfuse.secret_key
- **Type**: string
- **Description**: Langfuse secret API key

### CLAUDE.md Management (NEW)

#### claude_md_management.auto_init
- **Type**: boolean
- **Default**: `true`
- **Description**: Automatically create CLAUDE.md if it doesn't exist
- **Features**:
  - Detects project type (Node.js, Python, Go, Rust, etc.)
  - Generates appropriate template with relevant sections
  - Includes project structure and technology stack

#### claude_md_management.auto_update
- **Type**: boolean
- **Default**: `true`
- **Description**: Update CLAUDE.md at session end with learnings
- **What Gets Documented**:
  - Common commands and workflows
  - Architectural patterns and decisions
  - Setup instructions discovered
  - Gotchas and common issues

#### claude_md_management.update_threshold
- **Type**: integer
- **Default**: `3`
- **Description**: Minimum number of tool calls before updating CLAUDE.md
- **Purpose**: Avoids updates for trivial sessions

#### claude_md_management.max_file_size
- **Type**: integer
- **Default**: `10240` (10KB)
- **Description**: Maximum size for CLAUDE.md in bytes
- **Purpose**: Keeps file concise and focused

#### claude_md_management.backup_before_update
- **Type**: boolean
- **Default**: `true`
- **Description**: Create backup before updating CLAUDE.md
- **Location**: `.claude/claude-md-backups/CLAUDE.md.{timestamp}.bak`

## Usage

Copy this file to your project's `.claude/` directory:

```bash
cp .claude-dev-plugin.local.md.example .claude/dev-plugin.local.md
```

Then edit the settings as needed.

## Examples

### Disable All Checks

```yaml
---
enabled: false
---
```

### TypeScript with Strict Mode

```yaml
---
typescript:
  command: npx tsc --noEmit --strict
---
```

### Python with Custom Config

```yaml
---
python:
  mypy_command: mypy --config-file mypy.ini src/
  ruff_command: ruff check --select E,F src/
---
```

### Go with Specific Packages

```yaml
---
go:
  command: go build ./cmd/... ./pkg/...
---
```

### Multi-Language Project

```yaml
---
enabled: true
typescript:
  command: npx tsc --noEmit
python:
  mypy_command: mypy backend/
  ruff_command: ruff check backend/
---
```

### Disable Auto-Formatting Only

```yaml
---
autoformat:
  enabled: false
---
```

### Disable Git Checkpointing Only

```yaml
---
git_checkpoint:
  enabled: false
---
```

### Disable Notifications Only

```yaml
---
notifications:
  enabled: false
---
```

### Audio: Sound Effects Only (Minimalist)

```yaml
---
notifications:
  audio:
    mode: 'sound_only'
  approval:
    sound: true
    tts: false
  completion:
    sound: true
    tts: false
---
```

### Audio: TTS Only (Voice-First)

```yaml
---
notifications:
  audio:
    mode: 'tts_only'
  approval:
    sound: false
    tts: true
    voice: 'Trinoids'
  completion:
    sound: false
    tts: true
    contextual_voice: true
---
```

### Audio: Mixed Mode (Recommended!)

```yaml
---
notifications:
  audio:
    mode: 'mixed'
    sound_library: '~/.claude/audio'
  approval:
    sound: true
    tts: true
    voice: 'Trinoids'
  completion:
    sound: true
    tts: true
    contextual_voice: true
---
```

### Audio: Creative Random Sounds

```yaml
---
notifications:
  audio:
    mode: 'creative'
    sound_library: '~/.claude/audio-retro'  # Custom retro gaming pack
  approval:
    sound: true
    tts: false
  completion:
    sound: true
    tts: false
---
```

### Audio: Custom Voice Overrides

```yaml
---
notifications:
  completion:
    contextual_voice: false  # Use explicit voices instead
    voices:
      success: 'Jester'      # Fun voice for success
      error: 'Superstar'     # Dramatic voice for errors
      warning: 'Wobble'      # Unstable voice for warnings
      neutral: 'Bells'       # Musical voice for no changes
---
```

### Local-Only Observability (No Langfuse)

```yaml
---
observability:
  enabled: true  # Track sessions locally
  langfuse:
    enabled: false  # Don't send to Langfuse
---
```

### Observability with Local Langfuse

```yaml
---
observability:
  enabled: true
  langfuse:
    enabled: true
    host: http://localhost:3000
    public_key: pk-lf-local
    secret_key: sk-lf-local
---
```

### Observability with Remote Langfuse

```yaml
---
observability:
  enabled: true
  langfuse:
    enabled: true
    host: https://cloud.langfuse.com
    public_key: pk-lf-xxxxxxxx
    secret_key: sk-lf-xxxxxxxx
---
```

### Disable CLAUDE.md Auto-Management

```yaml
---
claude_md_management:
  auto_init: false
  auto_update: false
---
```

### CLAUDE.md with Custom Settings

```yaml
---
claude_md_management:
  auto_init: true
  auto_update: true
  update_threshold: 5        # Update only after 5+ tool calls
  max_file_size: 15360       # Allow up to 15KB
  backup_before_update: true
---
```

### Complete Feature Control

```yaml
---
# Quality checks
typescript:
  command: npx tsc --noEmit --strict

# Auto-formatting
autoformat:
  enabled: true

# Git checkpointing
git_checkpoint:
  enabled: true

# Notifications with TTS disabled
notifications:
  enabled: true
  mac_notification: true
  tts: false

# Observability tracking
observability:
  enabled: true
  langfuse:
    enabled: true
    host: http://localhost:3000
    public_key: pk-lf-local
    secret_key: sk-lf-local

# CLAUDE.md management
claude_md_management:
  auto_init: true
  auto_update: true
  update_threshold: 3
---
```

## Sound Library Setup

### Quick Start

1. **Create sound library:**
   ```bash
   mkdir -p ~/.claude/audio/{success,error,waiting,notify}
   ```

2. **Add custom sounds (optional):**
   ```bash
   # Example: Add game sounds
   cp ~/Downloads/mario-coin.mp3 ~/.claude/audio/success/
   cp ~/Downloads/mario-jump.wav ~/.claude/audio/notify/
   cp ~/Downloads/game-over.mp3 ~/.claude/audio/error/
   ```

3. **Test sounds:**
   ```bash
   afplay ~/.claude/audio/success/mario-coin.mp3
   ```

4. **Enable in config:**
   ```yaml
   notifications:
     audio:
       mode: 'mixed'  # or 'sound_only', 'creative'
       sound_library: '~/.claude/audio'
   ```

### Available TTS Voices

macOS provides 150+ voices. Key voices used by the plugin:

| Voice | Character | Use Case |
|-------|-----------|----------|
| **Good News** | Upbeat, triumphant | Success notifications |
| **Bad News** | Somber, serious | Error notifications |
| **Bubbles** | Cheerful, friendly | General completion |
| **Trinoids** | Alien, attention-grabbing | "Come back!" alerts |
| **Bells** | Musical, clear | Approval needed |
| **Whisper** | Quiet, cautious | Warnings |
| **Wobble** | Wavering | Processing/waiting |
| **Zarvox** | Electronic, robotic | Technical/code quality |
| **Superstar** | Dramatic, urgent | Critical alerts |
| **Jester** | Playful | Fun messages |

**Test voices:** `say -v "Good News" "Test message"`
**List all voices:** `say -v '?'`

### Fallback Behavior

If no custom sounds exist, the plugin uses macOS system sounds:
- **success** â†’ Hero.aiff (triumphant)
- **error** â†’ Basso.aiff (warning tone)
- **waiting** â†’ Tink.aiff (gentle tick)
- **notify** â†’ Glass.aiff (clear ping)

Located in: `/System/Library/Sounds/`

### Sound Packs (Advanced)

Create themed sound packs for extra fun:

#### Retro Gaming Pack ðŸŽ®
```bash
mkdir -p ~/.claude/audio-retro/{success,error,notify}
# Add Mario, Zelda, Pac-Man sounds
```

#### Sci-Fi Pack ðŸš€
```bash
mkdir -p ~/.claude/audio-scifi/{success,error,notify}
# Add Star Trek, Star Wars sounds
```

#### Nature Sounds ðŸŒ¿
```bash
mkdir -p ~/.claude/audio-nature/{success,error,notify}
# Add bird chirps, wind chimes, etc.
```

**Switch packs in config:**
```yaml
audio:
  sound_library: '~/.claude/audio-retro'
```

For more details, see: `~/.claude/audio/README.md`

## Automatic Detection

The plugin automatically detects project types by looking for:

- **TypeScript**: `tsconfig.json`
- **Python**: `pyproject.toml`, `setup.py`, `requirements.txt`, `Pipfile`, `poetry.lock`
- **Go**: `go.mod`
- **Rust**: `Cargo.toml`

Only detected project types will be checked.

## Notes

- Changes to settings require restarting Claude Code
- The plugin runs all applicable checks based on detected project types
- Errors from any language will block session end
- Tools must be installed and available in PATH
